 --Find total customers by countries
select 
	country ,
	count(customer_key)as Total_customers
from gold.dim_customers
group by country 
order by Total_customers desc ;

--Find Total customers by gender 
select
		gender,
		count(customer_key) as Total_customers
from gold.dim_customers
group by gender
order by Total_customers desc ;

-- Find Total product by category 
select 
	category ,
	count(product_key) as total_product
from gold.dim_products
group by category
order by total_product desc ;

--What's AVG cost in each category ?

select 
	category ,
	AVG(cost) as average_cost
from gold.dim_products
group by category
order by average_cost desc ;

--What is totatl revenue is generated by each category 

select 
	
	pr.category,
	SUM(sl.sales_amount) as total_revenue
from gold.fact_sales sl
left join gold.dim_products pr
on sl.product_key = pr.product_key
group by pr.category 

--What is Total revenue is generated by each customer 

select 
cu.customer_key,
	cu.first_name,
	cu.last_name,
	sum(sl.sales_amount) as total_revenue 
from gold.fact_sales sl 
left join gold.dim_customers cu 
on sl.customer_key = cu.customer_key
group by cu.customer_key,
	cu.first_name,
	cu.last_name
order by total_revenue desc


-- what's the distribustion of sold items across countries

select 
	cu.country,
	SUM(sl.quantity) as total_items_sold
from gold.fact_sales sl 
left join gold.dim_customers cu
on sl.customer_key = cu.customer_key
group by cu.country 
order by total_items_sold desc
